import graph_world.models.basic_gnn

GeneratorBeamHandlerWrapper.handler = @LinkPredictionBeamHandler()
GeneratorBeamHandlerWrapper.nsamples = 5

LinkPredictionBeamHandler.param_sampler_specs = [
  @nvertex/ParamSamplerSpec(),
  @avg_degree/ParamSamplerSpec(),
  @feature_center_distance/ParamSamplerSpec(),
  @feature_dim/ParamSamplerSpec(),
  @edge_center_distance/ParamSamplerSpec(),
  @edge_feature_dim/ParamSamplerSpec(),
  @p_to_q_ratio/ParamSamplerSpec(),
  @num_clusters/ParamSamplerSpec(),
  @cluster_size_slope/ParamSamplerSpec()
]

nvertex/ParamSamplerSpec.name = "nvertex"
nvertex/ParamSamplerSpec.min_val = 32
nvertex/ParamSamplerSpec.max_val = 64

p_to_q_ratio/ParamSamplerSpec.name = "p_to_q_ratio"
p_to_q_ratio/ParamSamplerSpec.min_val = 1.0
p_to_q_ratio/ParamSamplerSpec.max_val = 10.0

avg_degree/ParamSamplerSpec.name = "avg_degree"
avg_degree/ParamSamplerSpec.min_val = 1.0
avg_degree/ParamSamplerSpec.max_val = 20.0

feature_dim/ParamSamplerSpec.name = "feature_dim"
feature_dim/ParamSamplerSpec.min_val = 16
feature_dim/ParamSamplerSpec.max_val = 16

feature_center_distance/ParamSamplerSpec.name = "feature_center_distance"
feature_center_distance/ParamSamplerSpec.min_val = 0.0
feature_center_distance/ParamSamplerSpec.max_val = 5.0

edge_center_distance/ParamSamplerSpec.name = "edge_center_distance"
edge_center_distance/ParamSamplerSpec.min_val = 2.0
edge_center_distance/ParamSamplerSpec.max_val = 2.0

edge_feature_dim/ParamSamplerSpec.name = "edge_feature_dim"
edge_feature_dim/ParamSamplerSpec.min_val = 2.0
edge_feature_dim/ParamSamplerSpec.max_val = 2.0

num_clusters/ParamSamplerSpec.name = "num_clusters"
num_clusters/ParamSamplerSpec.min_val = 2
num_clusters/ParamSamplerSpec.max_val = 6

cluster_size_slope/ParamSamplerSpec.name = "cluster_size_slope"
cluster_size_slope/ParamSamplerSpec.min_val = 0.0
cluster_size_slope/ParamSamplerSpec.max_val = 0.1

LinkPredictionBeamHandler.training_ratio = 0.9
LinkPredictionBeamHandler.benchmarker_wrappers = [
  @GCN_/LPBenchmark,
  @GraphSAGE_/LPBenchmark,
  @GIN_/LPBenchmark,
  @GAT_/LPBenchmark,
]

# GCN setup
GCN_/LPBenchmark.model_class = @GCN
GCN_/LPBenchmark.benchmark_params = {
    'epochs' : 256,
}
GCN_/LPBenchmark.h_params = {
    'in_channels' : 16,
    'hidden_channels' : 8,
    'num_layers' : 2,
}

# GraphSAGE setup
GraphSAGE_/LPBenchmark.model_class = @GraphSAGE
GraphSAGE_/LPBenchmark.benchmark_params = {
    'epochs' : 256,
}
GraphSAGE_/LPBenchmark.h_params = {
    'in_channels' : 16,
    'hidden_channels' : 8,
    'num_layers' : 2,
}

# GIN setup
GIN_/LPBenchmark.model_class = @GIN
GIN_/LPBenchmark.benchmark_params = {
    'epochs' : 256,
}
GIN_/LPBenchmark.h_params = {
    'in_channels' : 16,
    'hidden_channels' : 8,
    'num_layers' : 2,
}

# GAT setup
GAT_/LPBenchmark.model_class = @GAT
GAT_/LPBenchmark.benchmark_params = {
    'epochs' : 256,
}
GAT_/LPBenchmark.h_params = {
    'in_channels' : 16,
    'hidden_channels' : 8,
    'num_layers' : 2,
}